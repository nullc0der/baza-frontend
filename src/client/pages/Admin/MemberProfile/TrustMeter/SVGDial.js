import React, { Component } from 'react'
import isNumber from 'lodash/isNumber'

export default class SVGDial extends Component {

    componentDidMount = () => {
        setTimeout(this.fixDimensions, 2500)
        setTimeout(() => this.updatePathValue(this.props.value), 4000)
    }

    componentWillReceiveProps = (nextProps) => {
        if (this.props.value !== nextProps.value) {
            this.updatePathValue(nextProps.value)
        }
    }

    fixDimensions = () => {
        // const parentBounds = this.container.parentElement.getBoundingClientRect()
        // this.container.setAttribute('width', parentBounds.width + 'px')
        // this.container.setAttribute('height', parentBounds.height + 'px')
        // this.container.setAttribute('viewBox', `0 0 ${parentBounds.width} ${parentBounds.height}`)

        const pathLength = this.trackPath.getTotalLength()
        this.trackValue.style.strokeDasharray = pathLength
        this.trackValue.style.strokeDashoffset = pathLength
    }

    updatePathValue = (providedValue) => {
        const value = isNumber(providedValue) ? providedValue : 0
        const pathLength = this.trackPath.getTotalLength()

        const pathValue = pathLength * value * 0.01
        this.trackValue.style.strokeDashoffset = pathValue - pathLength
    }

    render() {
        return (
            <svg
                id='gauge-container'
                width="248px"
                height="129px"
                viewBox="0 0 248 129"
                version="1.1"
                preserveAspectRatio="xMidYMid meet"
                xmlns="http://www.w3.org/2000/svg"
                xmlnsXlink="http://www.w3.org/1999/xlink"
                ref={node => { this.container = node }}>
                <defs>
                    <linearGradient x1="2.02378206%" y1="52.0237821%" x2="97.9762179%" y2="52.0237821%" id="linearGradient-1">
                        <stop stopColor="#FC3800" offset="0%"></stop>
                        <stop stopColor="#F8A800" offset="26.88589%"></stop>
                        <stop stopColor="#CDCB02" offset="51.2453629%"></stop>
                        <stop stopColor="#8BD906" offset="77.7895851%"></stop>
                        <stop stopColor="#58E40A" offset="100%"></stop>
                    </linearGradient>
                </defs>
                <g stroke="none" strokeWidth="1" fill="none" fillRule="evenodd" strokeDasharray="1" strokeLinecap="round" strokeLinejoin="round">
                    <g transform="translate(-709.000000, -209.000000)" fillRule="nonzero" strokeWidth="10">
                        <g id="gauge" transform="translate(714.000000, 214.000000)">
                            <path
                                ref={node => { this.trackPath = node }}
                                d="M238,119 C238,53.2781148 184.721885,0 119,0 C53.2781148,0 0,53.2781148 0,119" id="track" stroke="#263850" opacity="0.15"></path>
                            <path
                                ref={node => { this.trackValue = node }}
                                d="M238,119 C238,53.2781148 184.721885,0 119,0 C53.2781148,0 0,53.2781148 0,119" id="value" stroke="url(#linearGradient-1)"></path>
                        </g>
                    </g>
                </g>
            </svg>
        )
    }
}

/* <svg
    width="248px"
    height="129px"
    viewBox="0 0 248 129"
    version="1.1"
    xmlns="http://www.w3.org/2000/svg"
    xmlnsXlink="http://www.w3.org/1999/xlink"
    ref={node => { this.container = node }}>
    <defs>
        <linearGradient x1="2.02378206%" y1="52.0237821%" x2="97.9762179%" y2="52.0237821%" id="linearGradient-1">
            <stop stopColor="#FC3800" offset="0%"></stop>
            <stop stopColor="#F8A800" offset="26.88589%"></stop>
            <stop stopColor="#CDCB02" offset="51.2453629%"></stop>
            <stop stopColor="#8BD906" offset="77.7895851%"></stop>
            <stop stopColor="#58E40A" offset="100%"></stop>
        </linearGradient>
    </defs>
    <g stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
        <path d="M0.26,115.92 C0.26,115.75 0.29,115.58 0.32,115.41 L0.32,114.88 C0.45,113.18 0.61,111.48 0.8,109.78 C0.82,109.61 0.85,109.45 0.89,109.28 L1.19,106.71 C1.33,105.68 1.8,102.79 1.83,102.62 L3.3,95.46 L3.55,94.44 L4.33,91.41 L4.9,89.39 C5.56226969,87.2223732 6.25902473,85.0654329 6.99,82.92 L9,77.54 C9.06,77.37 12.17,70.38 12.39,69.91 L16.29,62.52 L17.88,59.81 L18.43,58.93 L20.68,55.41 L21.86,53.68 L25.54,48.61 L26.82,46.97 C26.92,46.83 27.05,46.7 27.17,46.57 L29.47,43.75 C29.54,43.65 30,43.13 30.84,42.16 L32.6,40.24 C32.7,40.1 34.24,38.45 34.36,38.32 L35.08,37.57 L38.04,34.63 L40.29,32.52 C40.54,32.29 40.79,32.05 41.06,31.82 L44.18,29.1 L44.98,28.43 L45.79,27.77 L48.25,25.82 L49.91,24.55 L53.3,22.11 L54.16,21.52 C54.74,21.14 54.88,21.03 55.03,20.93 L60.33,17.58 L61.22,17.05 L66.69,14.01 L67.62,13.53 L71.37,11.69 L72.32,11.25 L76.14,9.58 L77.11,9.18 L82.92,6.97 L83.91,6.63 L88.89,5.04 L89.89,4.74 C90.58,4.57 90.74,4.51 90.91,4.46 L91.91,4.19 L104.14,1.58 L105.18,1.42 L109.31,0.86 L110.34,0.74 L111.39,0.64 L117.62,0.16 L118.67,0.11 L119.7,0.07 C120.05,0.07 126.65,0.02 126.99,0.04 L128.04,0.06 L129.08,0.1 L130.12,0.15 L138.33,0.82 L139.37,0.94 L140.4,1.08 L141.44,1.22 L145.52,1.86 C146.19,1.99 146.36,2.01 146.53,2.04 L147.55,2.24 L148.58,2.44 L152.67,3.33 L153.69,3.58 L157.72,4.64 L158.74,4.94 L169.61,8.66 C170.25,8.93 170.41,8.98 170.58,9.05 L173.47,10.27 L174.43,10.69 L178.21,12.45 L179.15,12.91 L180.08,13.38 L181.01,13.86 L187.4,17.41 L188.3,17.95 L189.19,18.5 L190.07,19.05 C190.65,19.43 190.81,19.52 190.96,19.61 L191.83,20.18 L196.98,23.74 C197.12,23.84 197.26,23.95 197.38,24.07 C197.95,24.47 198.51,24.89 199.06,25.32 C199.62,25.73 200.17,26.16 200.71,26.6 C201.26,27.02 201.81,27.45 202.33,27.9 C203.03,28.43 203.7,28.98 204.35,29.56 L205.15,30.24 L205.52,30.59 C206.19,31.14 206.85,31.72 207.48,32.32 L209.77,34.45 L210.13,34.83 C210.22,34.9 210.59,35.25 211.26,35.9 C211.39,36.03 215.7,40.52 216.96,41.94 L217.28,42.34 L217.64,42.71 C218.777606,44.0167153 219.887847,45.3470043 220.97,46.7 L221.27,47.13 C221.6,47.53 224.04,50.72 224.14,50.86 L224.76,51.71 C224.86,51.85 224.96,52 225.04,52.15 L227.13,55.14 C227.23,55.28 227.33,55.44 227.4,55.59 C227.51,55.72 227.62,55.86 227.71,56.01 L229.4,58.65 C229.5,58.8 229.58,58.95 229.65,59.11 L229.95,59.54 L232.06,63.14 L232.57,64.05 L234.53,67.74 L234.74,68.22 C234.81,68.32 235.35,69.41 236.37,71.5 L236.57,71.98 L236.8,72.44 L238.88,77.23 L239.05,77.73 C239.12,77.87 239.2,78.03 239.26,78.2 C239.696478,79.3204553 240.116523,80.4472428 240.52,81.58 C240.71,82.07 242.22,86.52 242.39,87.01 C242.44,87.19 242.49,87.36 242.52,87.53 L242.69,88.02 L242.99,89.02 C243.04,89.19 243.65,91.37 243.67,91.54 C243.74,91.7 243.79,91.87 243.84,92.04 L244.61,95.08 L244.71,95.59 C244.84,96.09 245.4,98.64 245.51,99.15 C245.54,99.32 245.57,99.5 245.58,99.67 C245.63,99.83 245.68,100 245.71,100.17 C245.91,101.19 246.1,102.21 246.27,103.23 L246.33,103.75 C246.43,104.26 246.51,104.78 246.6,105.29 L246.75,106.34 L246.89,107.37 L247.57,113.6 C247.58,113.78 247.59,113.95 247.58,114.12 C247.61,114.29 247.98,122.27 247.96,122.44 L247.99,122.95 L247.99,124 C247.99,126.761424 245.751424,129 242.99,129 C240.228576,129 237.99,126.761424 237.99,124 C237.99,116.48 237.27,108.99 235.83,101.61 C232.089727,82.8476207 223.66133,65.3371947 211.33,50.71 L211.03,50.34 L208.83,47.84 L208.53,47.48 C206.86,45.71 206,44.78 205.93,44.7 L204.91,43.7 C204.79402,43.5821329 204.683888,43.4586514 204.58,43.33 C203.312241,42.1139436 202.03554,40.9072442 200.75,39.71 C200.44,39.41 199.72,38.78 198.6,37.79 L197.87,37.17 C197.54,36.89 196.56,36.07 194.91,34.73 L194.15,34.13 L192.63,32.96 L190.31,31.26 L189.53,30.7 L185.55,28.03 L183.92,27.01 C183.38,26.66 183.24,26.58 183.1,26.5 L180.62,25.03 L179.79,24.56 L178.95,24.09 L172.98,21.03 L172.11,20.62 C170.955347,20.0630091 169.78486,19.5394578 168.6,19.05 L167.7,18.68 L165.04,17.61 C164.44,17.37 164.29,17.32 164.14,17.27 C162.634062,16.7252354 161.124019,16.1918868 159.61,15.67 L158.7,15.37 L157.78,15.09 C157.38,14.96 156.46,14.69 155.01,14.27 L150.37,13.06 L148.5,12.64 C147.87,12.49 147.7,12.47 147.55,12.44 L143.79,11.71 L142.85,11.55 C140.970331,11.2359711 139.083069,10.9692203 137.19,10.75 L135.32,10.55 L133.44,10.39 L132.51,10.31 L129.63,10.14 L127.72,10.06 C127.29,10.04 126.33,10.02 124.83,10.01 L124,10 L122.92,10 L114.31,10.41 C113.67,10.45 113.51,10.48 113.34,10.49 L108.58,11.03 C107.95,11.11 107.79,11.14 107.63,11.17 L104.78,11.61 C104.15,11.71 103.98,11.75 103.83,11.78 L101.03,12.31 L100.09,12.51 L97.29,13.14 L96.35,13.37 L95.42,13.61 L90.8,14.91 L88.06,15.78 L82.66,17.72 L81.78,18.07 L80.89,18.43 L75.62,20.74 L74.76,21.15 L70.47,23.32 L67.12,25.18 L63.82,27.15 L63.02,27.67 L59,30.33 C58.65,30.56 58.13,30.93 57.44,31.43 C57.09,31.68 56.07,32.44 54.36,33.73 L53.6,34.33 L48.45,38.62 L47.75,39.25 L45.67,41.17 L44.97,41.84 L39.62,47.33 L38.98,48.05 L38.35,48.76 C29.8828288,58.4065206 23.0951674,69.4060475 18.27,81.3 C13.8383661,92.2539074 11.1491332,103.834142 10.3,115.62 L10.24,116.1 L10.24,116.58 C10.09,118.81 10.01,121.05 10,123.29 C9.98343146,126.051424 7.73142375,128.276569 4.97,128.26 C2.20857625,128.243431 -0.0165685425,125.991424 -5.77320039e-15,123.23 L0.01,122.19 C0.01,122.01 0.03,121.84 0.05,121.66 C0.03,121.49 0.05,120.44 0.06,120.1" id="progress-track" fill="#273951" fillRule="nonzero" opacity="0.15"></path>
        <path d="M0.26,115.92 C0.26,115.75 0.29,115.58 0.32,115.41 L0.32,114.88 C0.45,113.18 0.61,111.48 0.8,109.78 C0.82,109.61 0.85,109.45 0.89,109.28 L1.19,106.71 C1.33,105.68 1.8,102.79 1.83,102.62 L3.3,95.46 L3.55,94.44 L4.33,91.41 L4.9,89.39 C5.56226969,87.2223732 6.25902473,85.0654329 6.99,82.92 L9,77.54 C9.06,77.37 12.17,70.38 12.39,69.91 L16.29,62.52 L17.88,59.81 L18.43,58.93 L20.68,55.41 L21.86,53.68 L25.54,48.61 L26.82,46.97 C26.92,46.83 27.05,46.7 27.17,46.57 L29.47,43.75 C29.54,43.65 30,43.13 30.84,42.16 L32.6,40.24 C32.7,40.1 34.24,38.45 34.36,38.32 L35.08,37.57 L38.04,34.63 L40.29,32.52 C40.54,32.29 40.79,32.05 41.06,31.82 L44.18,29.1 L44.98,28.43 L45.79,27.77 L48.25,25.82 L49.91,24.55 L53.3,22.11 L54.16,21.52 C54.74,21.14 54.88,21.03 55.03,20.93 L60.33,17.58 L61.22,17.05 L66.69,14.01 L67.62,13.53 L71.37,11.69 L72.32,11.25 L76.14,9.58 L77.11,9.18 L82.92,6.97 L83.91,6.63 L88.89,5.04 L89.89,4.74 C90.58,4.57 90.74,4.51 90.91,4.46 L91.91,4.19 L104.14,1.58 L105.18,1.42 L109.31,0.86 L110.34,0.74 L111.39,0.64 L117.62,0.16 L118.67,0.11 L119.7,0.07 C120.05,0.07 126.65,0.02 126.99,0.04 L128.04,0.06 L129.08,0.1 L130.12,0.15 L138.33,0.82 L139.37,0.94 L140.4,1.08 L141.44,1.22 L145.52,1.86 C146.19,1.99 146.36,2.01 146.53,2.04 L147.55,2.24 L148.58,2.44 L152.67,3.33 L153.69,3.58 L157.72,4.64 L158.74,4.94 L169.61,8.66 C170.25,8.93 170.41,8.98 170.58,9.05 L173.47,10.27 L174.43,10.69 L178.21,12.45 L179.15,12.91 L180.08,13.38 L181.01,13.86 L187.4,17.41 L188.3,17.95 L189.19,18.5 L190.07,19.05 C190.65,19.43 190.81,19.52 190.96,19.61 L191.83,20.18 L196.98,23.74 C197.12,23.84 197.26,23.95 197.38,24.07 C197.95,24.47 198.51,24.89 199.06,25.32 C199.62,25.73 200.17,26.16 200.71,26.6 C201.26,27.02 201.81,27.45 202.33,27.9 C203.03,28.43 203.7,28.98 204.35,29.56 L205.15,30.24 L205.52,30.59 C206.19,31.14 206.85,31.72 207.48,32.32 L209.77,34.45 L210.13,34.83 C210.22,34.9 210.59,35.25 211.26,35.9 C211.39,36.03 215.7,40.52 216.96,41.94 L217.28,42.34 L217.64,42.71 C218.777606,44.0167153 219.887847,45.3470043 220.97,46.7 L221.27,47.13 C221.6,47.53 224.04,50.72 224.14,50.86 L224.76,51.71 C224.86,51.85 224.96,52 225.04,52.15 L227.13,55.14 C227.23,55.28 227.33,55.44 227.4,55.59 C227.51,55.72 227.62,55.86 227.71,56.01 L229.4,58.65 C229.5,58.8 229.58,58.95 229.65,59.11 L229.95,59.54 L232.06,63.14 L232.57,64.05 L234.53,67.74 L234.74,68.22 C234.81,68.32 235.35,69.41 236.37,71.5 L236.57,71.98 L236.8,72.44 L238.88,77.23 L239.05,77.73 C239.12,77.87 239.2,78.03 239.26,78.2 C239.696478,79.3204553 240.116523,80.4472428 240.52,81.58 C240.71,82.07 242.22,86.52 242.39,87.01 C242.44,87.19 242.49,87.36 242.52,87.53 L242.69,88.02 L242.99,89.02 C243.04,89.19 243.65,91.37 243.67,91.54 C243.74,91.7 243.79,91.87 243.84,92.04 L244.61,95.08 L244.71,95.59 C244.84,96.09 245.4,98.64 245.51,99.15 C245.54,99.32 245.57,99.5 245.58,99.67 C245.63,99.83 245.68,100 245.71,100.17 C245.91,101.19 246.1,102.21 246.27,103.23 L246.33,103.75 C246.43,104.26 246.51,104.78 246.6,105.29 L246.75,106.34 L246.89,107.37 L247.57,113.6 C247.58,113.78 247.59,113.95 247.58,114.12 C247.61,114.29 247.98,122.27 247.96,122.44 L247.99,122.95 L247.99,124 C247.99,126.761424 245.751424,129 242.99,129 C240.228576,129 237.99,126.761424 237.99,124 C237.99,116.48 237.27,108.99 235.83,101.61 C232.089727,82.8476207 223.66133,65.3371947 211.33,50.71 L211.03,50.34 L208.83,47.84 L208.53,47.48 C206.86,45.71 206,44.78 205.93,44.7 L204.91,43.7 C204.79402,43.5821329 204.683888,43.4586514 204.58,43.33 C203.312241,42.1139436 202.03554,40.9072442 200.75,39.71 C200.44,39.41 199.72,38.78 198.6,37.79 L197.87,37.17 C197.54,36.89 196.56,36.07 194.91,34.73 L194.15,34.13 L192.63,32.96 L190.31,31.26 L189.53,30.7 L185.55,28.03 L183.92,27.01 C183.38,26.66 183.24,26.58 183.1,26.5 L180.62,25.03 L179.79,24.56 L178.95,24.09 L172.98,21.03 L172.11,20.62 C170.955347,20.0630091 169.78486,19.5394578 168.6,19.05 L167.7,18.68 L165.04,17.61 C164.44,17.37 164.29,17.32 164.14,17.27 C162.634062,16.7252354 161.124019,16.1918868 159.61,15.67 L158.7,15.37 L157.78,15.09 C157.38,14.96 156.46,14.69 155.01,14.27 L150.37,13.06 L148.5,12.64 C147.87,12.49 147.7,12.47 147.55,12.44 L143.79,11.71 L142.85,11.55 C140.970331,11.2359711 139.083069,10.9692203 137.19,10.75 L135.32,10.55 L133.44,10.39 L132.51,10.31 L129.63,10.14 L127.72,10.06 C127.29,10.04 126.33,10.02 124.83,10.01 L124,10 L122.92,10 L114.31,10.41 C113.67,10.45 113.51,10.48 113.34,10.49 L108.58,11.03 C107.95,11.11 107.79,11.14 107.63,11.17 L104.78,11.61 C104.15,11.71 103.98,11.75 103.83,11.78 L101.03,12.31 L100.09,12.51 L97.29,13.14 L96.35,13.37 L95.42,13.61 L90.8,14.91 L88.06,15.78 L82.66,17.72 L81.78,18.07 L80.89,18.43 L75.62,20.74 L74.76,21.15 L70.47,23.32 L67.12,25.18 L63.82,27.15 L63.02,27.67 L59,30.33 C58.65,30.56 58.13,30.93 57.44,31.43 C57.09,31.68 56.07,32.44 54.36,33.73 L53.6,34.33 L48.45,38.62 L47.75,39.25 L45.67,41.17 L44.97,41.84 L39.62,47.33 L38.98,48.05 L38.35,48.76 C29.8828288,58.4065206 23.0951674,69.4060475 18.27,81.3 C13.8383661,92.2539074 11.1491332,103.834142 10.3,115.62 L10.24,116.1 L10.24,116.58 C10.09,118.81 10.01,121.05 10,123.29 C9.98343146,126.051424 7.73142375,128.276569 4.97,128.26 C2.20857625,128.243431 -0.0165685425,125.991424 -5.77322749e-15,123.23 L0.01,122.19 C0.01,122.01 0.03,121.84 0.05,121.66 C0.03,121.49 0.05,120.44 0.06,120.1" id="progress-value" fill="url(#linearGradient-1)" fillRule="nonzero"></path>
    </g>
</svg> */
